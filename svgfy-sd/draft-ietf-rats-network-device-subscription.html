<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Attestation Event Stream Subscription</title>
<meta content="Henk Birkholz" name="author">
<meta content="Eric Voit" name="author">
<meta content="Wei Pan" name="author">
<meta content="
       This document defines how to subscribe to YANG Event Streams for Remote Attestation Procedures (RATS).
Specifically, this document defines a YANG module that augments the YANG module for TPM-based Challenge-Response Remote Attestation (CHARRA), enabling subscription to RATS Conceptual Messages of the Evidence type.
The module defined requires at least one TPM 1.2 or TPM 2.0 (or equivalent hardware implementation providing the same protected capabilities as a TPM) must be available on the Attester on which the YANG server is running. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-rats-network-device-subscription-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-ietf-rats-network-device-subscription.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RATS Subscription</td>
<td class="right">December 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Birkholz, et al.</td>
<td class="center">Expires 19 June 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">RATS Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-rats-network-device-subscription-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-12-16" class="published">16 December 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-06-19">19 June 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">E. Voit</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">W. Pan</div>
<div class="org">Huawei</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Attestation Event Stream Subscription</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines how to subscribe to YANG Event Streams for Remote Attestation Procedures (RATS).
Specifically, this document defines a YANG module that augments the YANG module for TPM-based Challenge-Response Remote Attestation (CHARRA), enabling subscription to RATS Conceptual Messages of the Evidence type.
The module defined requires at least one TPM 1.2 or TPM 2.0 (or equivalent hardware implementation providing the same protected capabilities as a TPM) must be available on the Attester on which the YANG server is running.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Remote ATtestation ProcedureS Working Group mailing list (rats@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/rats/">https://mailarchive.ietf.org/arch/browse/rats/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/ietf-rats-wg/draft-ietf-rats-network-device-subscription">https://github.com/ietf-rats-wg/draft-ietf-rats-network-device-subscription</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 June 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-requirements-notation" class="internal xref">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-operational-model" class="internal xref">Operational Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-sequence-diagram" class="internal xref">Sequence Diagram</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-term-specialization" class="internal xref">Term Specialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-time-considerations-mapping" class="internal xref">Time Considerations Mapping</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-continuously-verifying-fres" class="internal xref">Continuously Verifying Freshness</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-tpm-12-quote" class="internal xref">TPM 1.2 Quote</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-tpm-2-quote" class="internal xref">TPM 2 Quote</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-remote-attestation-event-st" class="internal xref">Remote Attestation Event Stream</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-subscription-to-the-attesta" class="internal xref">Subscription to the &lt;attestation&gt; Event Stream</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-replaying-a-history-of-prev" class="internal xref">Replaying a history of previous TPM extend operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-tpm2-heartbeat" class="internal xref">TPM2 Heartbeat</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-yang-notifications-placed-o" class="internal xref">YANG notifications placed on the &lt;attestation&gt; Event Stream</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-pcr-extend" class="internal xref">pcr-extend</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-tpm12-attestation" class="internal xref">tpm12-attestation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="auto internal xref">4.3.3</a>.  <a href="#name-tpm20-attestation" class="internal xref">tpm20-attestation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-filtering-evidence-at-the-a" class="internal xref">Filtering Evidence at the Attester</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-replaying-previous-pcr-exte" class="internal xref">Replaying previous PCR Extend events</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-configuring-the-attestation" class="internal xref">Configuring the &lt;attestation&gt; Event Stream</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-yang-module" class="internal xref">YANG Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-event-streams-for-conceptua" class="internal xref">Event Streams for Conceptual Messages</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span> and <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> define the operational prerequisites and a YANG Model for acquiring Evidence from a network device containing at least one TPM 1.2 or TPM 2.0 (or equivalent hardware implementations providing the same protected capabilities <span>[<a href="#TCG-Glossary" class="cite xref">TCG-Glossary</a>]</span> as a TPM).
However, these documents are based on the challenge-response interaction model (CHARRA in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15#section-7.1" class="relref">Section 7.1</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>), which has limitations.
One such limitation is that it is the responsibility of a Verifier to request signed Evidence from a separate Attester containing a TPM.
This means that the interval between a security-relevant change event occurring and the event becoming visible to the interested RATS entities, such as a Verifiers or a Relying Parties, can be unacceptably long.
It is common to convey Conceptual Messages ad-hoc or periodically via requests.
As new technologies emerge, some of these solutions require Conceptual Messages to be conveyed from one RATS entity to another without the need for continuous polling.
Subscription to YANG Notifications <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> provides a set of standardized tools to facilitate these emerging requirements.
This memo specifies a YANG augmentation for subscribing to YANG-modelled remote attestation Evidence, as defined in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Essentially, the limitation of poll-based interactions has two adverse effects:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-3">
<li id="section-1-3.1">
          <p id="section-1-3.1.1">Conceptual Messages are not streamed to interested consumers of information (e.g., Verifiers or Relying Parties) as soon as they are generated.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-3.2">
          <p id="section-1-3.2.1">Even if they were streamed, the freshness of Conceptual Messages cannot be appraised in every scenario.
This is particularly important for Conceptual Messages that depend heavily on freshness, such as Evidence and the corresponding Attestation Results.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-4">This specification addresses the first adverse effect by enabling consumers of Conceptual Messages (subscribers) to request a continuous stream of new or updated Conceptual Messages via an <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> subscription to an &lt;attestation&gt; Event Stream.
This new Event Stream is defined in this document and is provided by the producer of Conceptual Messages (the publisher).
In the case of a Verifier's subscription to an Attester's Evidence, the Attester will continuously stream a requested set of freshly generated Evidence to the subscribing Verifier.
For example, when a network device's Evidence changes following events such as booting, updating, control unit fallover, plugging in or out of forwarding units, an attack, or certificate lifetime change, the network device will generate fresh Evidence available to the subscribing Verifier.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The second adverse effect stems from the use of nonces in the challenge-response interaction model <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15#section-7.1" class="relref">Section 7.1</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span> realized in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.
According to <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>, an Attester must wait for a new nonce from a Verifier before generating a new TPM Quote.
To address delays resulting from this wait, this specification allows freshness to be asserted asynchronously via the streaming attestation interaction model <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>.
To convey a RATS Conceptual Message, an initial nonce is provided when subscribing to an Event Stream.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">There are several options to populate or refresh the nonce value provided by the initial subscription.
All of these methods are out-of-band of an established subscription to YANG Notifications.
Two alternative methods are taken into account by this document:<a href="#section-1-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-7">
<li id="section-1-7.1">
          <p id="section-1-7.1.1">A central provider supplies new, fresh nonces (e.g., via a Handle Provider that distributes Epoch IDs to all entities in a domain as described in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> and as facilitated by the Uni-Directional Remote Attestation described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15#section-7.2" class="relref">Section 7.2</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>), or<a href="#section-1-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-7.2">
          <p id="section-1-7.2.1">A nonce can be updated by -- potentially periodically or ad-hoc -- sending out-of-band TPM Quote requests as facilitated by <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.<a href="#section-1-7.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-1-8">Both approaches assume that clock drift can occur between the entities involved.
Consequently, other conditions arising in different application scenarios ought to be considered in the same way. For example, the time of Claims collection ought to be taken into account.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">The scope of this document is limited to the removal of the two adverse effects described when using the specified YANG augmentation.
For example, the YANG augmentation enables a RATS Verifier to maintain a continuous appraisal procedure of verifiably fresh Attester Evidence without relying on continuous polling.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The following terms are imported from <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>: Attester, Conceptual Message, Evidence, Relying Party, and Verifier.  Also imported are the time definitions time(VG), time(NS), time(EG), time(RG), and time(RA) from that document's Appendix A.  The following terms are imported from <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>: Event Stream, Subscription, Publisher, Event Stream Filter, Dynamic Subscription.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="requirements-notation">
<section id="section-2.1">
        <h3 id="name-requirements-notation">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-2.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-model">
<section id="section-3">
      <h2 id="name-operational-model">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-operational-model" class="section-name selfRef">Operational Model</a>
      </h2>
<p id="section-3-1"><span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span> describes the conveyance of TPM-based Evidence from a Verifier to an Attester using the CHARRA interaction model <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15#section-7.1" class="relref">Section 7.1</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>. The operational model and corresponding sequence diagram described in this section is based on <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>. The basis for interoperability required for additional types of Event Streams is covered in <a href="#otherstreams" class="auto internal xref">Section 6</a>. The following sub-section focuses on subscription to YANG Notifications to the &lt;attestation&gt; Event Stream.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="sequence-diagram">
<section id="section-3.1">
        <h3 id="name-sequence-diagram">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-sequence-diagram" class="section-name selfRef">Sequence Diagram</a>
        </h3>
<p id="section-3.1-1"><a href="#sequence" class="auto internal xref">Figure 2</a> below is a sequence diagram which updates Figure 5 of <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span>. This sequence diagram adapts <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span> by replacing the TPM-specific challenge-response interaction model with a <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> Dynamic Subscription to an &lt;attestation&gt; Event Stream. The contents of the &lt;attestation&gt; Event Stream are defined below within <a href="#attestationstream" class="auto internal xref">Section 4</a>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="term-specialization">
<section id="section-3.1.1">
          <h4 id="name-term-specialization">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-term-specialization" class="section-name selfRef">Term Specialization</a>
          </h4>
<p id="section-3.1.1-1">The terms defined in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> are mapped to the model described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15#section-7.3.1" class="relref">Section 7.3.1</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span> (Streaming Remote Attestation without a Broker) to produce the sequence diagram <a href="#newsequence" class="auto internal xref">Figure 1</a>.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">The terminology specialization is as follows:
* <code>handle</code> is substituted with <code>nonce</code>, a nonce generated by the Verifier. This is a nonce-value byte string, obtained from either the tpm12-challenge-response-attestation RPC or the tpm20-challenge-response-attestation RPC, as specified in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>. Hence, in this case, a 'nonce' value is populated out of band and can be used more than once within the scope of a subscription, based on local policies that enforce freshness requirements.
* <code>attEnvIDs</code> is substituted with <code>TpmName</code>, a TPM "name" text string selected from the <code>tpms</code> Container, as specified in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>
* <code>claimsSelection</code> is substituted with <code>PcrSelection</code>, an optional "pcr-index" from either the tpm12-challenge-response-attestation RPC or the tpm20-challenge-response-attestation RPC as specified in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>. If no PCR is selected, all PCR banks are returned.
* <code>claims</code> is substituted with <code>PcrQuotes</code>, which is the "output" of either the tpm12-challenge-response-attestation RPC or the tpm20-challenge-response-attestation RPC, as specified in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>. Unlike event logs, there is no delta to a previous iteration of PCR Quotes during a subscription; all new (selected) Quotes are conveyed as fresh Evidence.
* <code>eventLogs</code> represents "system-event-logs" that are in the "output" of the log-retrieval RPC, as defined in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.
* <code>eventLogsDelta</code> represents "system-event-logs" as specified in the "output" of the log-retrieval RPC as defined in <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> where the "output" is limited as if the "input" were parameterized via an index type (last-entry, index, timestamp) set to the last event in the previously conveyed <code>eventLogs</code>.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<span id="name-yang-subscription-model-for"></span><div id="newsequence">
<figure id="figure-1">
            <div id="section-3.1.1-3.1">
              <div class="alignLeft art-svg artwork" id="section-3.1.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="992" width="584" viewBox="0 0 584 992" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                  <path d="M 8,112 L 8,944" fill="none" stroke="black"></path>
                  <path d="M 16,608 L 16,928" fill="none" stroke="black"></path>
                  <path d="M 48,64 L 48,88" fill="none" stroke="black"></path>
                  <path d="M 48,144 L 48,240" fill="none" stroke="black"></path>
                  <path d="M 48,304 L 48,320" fill="none" stroke="black"></path>
                  <path d="M 48,352 L 48,368" fill="none" stroke="black"></path>
                  <path d="M 48,400 L 48,448" fill="none" stroke="black"></path>
                  <path d="M 48,480 L 48,544" fill="none" stroke="black"></path>
                  <path d="M 48,672 L 48,688" fill="none" stroke="black"></path>
                  <path d="M 48,720 L 48,736" fill="none" stroke="black"></path>
                  <path d="M 48,768 L 48,816" fill="none" stroke="black"></path>
                  <path d="M 48,848 L 48,936" fill="none" stroke="black"></path>
                  <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                  <path d="M 360,32 L 360,64" fill="none" stroke="black"></path>
                  <path d="M 536,64 L 536,88" fill="none" stroke="black"></path>
                  <path d="M 536,176 L 536,240" fill="none" stroke="black"></path>
                  <path d="M 536,272 L 536,448" fill="none" stroke="black"></path>
                  <path d="M 536,640 L 536,816" fill="none" stroke="black"></path>
                  <path d="M 536,912 L 536,936" fill="none" stroke="black"></path>
                  <path d="M 552,880 L 552,888" fill="none" stroke="black"></path>
                  <path d="M 560,512 L 560,520" fill="none" stroke="black"></path>
                  <path d="M 568,608 L 568,928" fill="none" stroke="black"></path>
                  <path d="M 576,32 L 576,64" fill="none" stroke="black"></path>
                  <path d="M 576,112 L 576,944" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                  <path d="M 360,32 L 576,32" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                  <path d="M 360,64 L 576,64" fill="none" stroke="black"></path>
                  <path d="M 24,96 L 80,96" fill="none" stroke="black"></path>
                  <path d="M 136,96 L 560,96" fill="none" stroke="black"></path>
                  <path d="M 24,126 L 216,126" fill="none" stroke="black"></path>
                  <path d="M 24,130 L 216,130" fill="none" stroke="black"></path>
                  <path d="M 368,126 L 560,126" fill="none" stroke="black"></path>
                  <path d="M 368,130 L 560,130" fill="none" stroke="black"></path>
                  <path d="M 56,208 L 200,208" fill="none" stroke="black"></path>
                  <path d="M 128,224 L 528,224" fill="none" stroke="black"></path>
                  <path d="M 24,254 L 136,254" fill="none" stroke="black"></path>
                  <path d="M 24,258 L 136,258" fill="none" stroke="black"></path>
                  <path d="M 432,254 L 560,254" fill="none" stroke="black"></path>
                  <path d="M 432,258 L 560,258" fill="none" stroke="black"></path>
                  <path d="M 240,432 L 528,432" fill="none" stroke="black"></path>
                  <path d="M 24,462 L 208,462" fill="none" stroke="black"></path>
                  <path d="M 24,466 L 208,466" fill="none" stroke="black"></path>
                  <path d="M 376,462 L 560,462" fill="none" stroke="black"></path>
                  <path d="M 376,466 L 560,466" fill="none" stroke="black"></path>
                  <path d="M 32,592 L 88,592" fill="none" stroke="black"></path>
                  <path d="M 144,592 L 552,592" fill="none" stroke="black"></path>
                  <path d="M 32,622 L 120,622" fill="none" stroke="black"></path>
                  <path d="M 32,626 L 120,626" fill="none" stroke="black"></path>
                  <path d="M 464,622 L 552,622" fill="none" stroke="black"></path>
                  <path d="M 464,626 L 552,626" fill="none" stroke="black"></path>
                  <path d="M 280,800 L 528,800" fill="none" stroke="black"></path>
                  <path d="M 32,830 L 184,830" fill="none" stroke="black"></path>
                  <path d="M 32,834 L 184,834" fill="none" stroke="black"></path>
                  <path d="M 400,830 L 552,830" fill="none" stroke="black"></path>
                  <path d="M 400,834 L 552,834" fill="none" stroke="black"></path>
                  <path d="M 32,944 L 552,944" fill="none" stroke="black"></path>
                  <path d="M 24,960 L 560,960" fill="none" stroke="black"></path>
                  <path d="M 24,96 C 15.16936,96 8,103.16936 8,112" fill="none" stroke="black"></path>
                  <path d="M 560,96 C 568.83064,96 576,103.16936 576,112" fill="none" stroke="black"></path>
                  <path d="M 32,592 C 23.16936,592 16,599.16936 16,608" fill="none" stroke="black"></path>
                  <path d="M 552,592 C 560.83064,592 568,599.16936 568,608" fill="none" stroke="black"></path>
                  <path d="M 32,944 C 23.16936,944 16,936.83064 16,928" fill="none" stroke="black"></path>
                  <path d="M 552,944 C 560.83064,944 568,936.83064 568,928" fill="none" stroke="black"></path>
                  <path d="M 24,960 C 15.16936,960 8,952.83064 8,944" fill="none" stroke="black"></path>
                  <path d="M 560,960 C 568.83064,960 576,952.83064 576,944" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="536,800 524,794.4 524,805.6" fill="black" transform="rotate(0,528,800)"></polygon>
                  <polygon class="arrowhead" points="536,432 524,426.4 524,437.6" fill="black" transform="rotate(0,528,432)"></polygon>
                  <polygon class="arrowhead" points="536,224 524,218.4 524,229.6" fill="black" transform="rotate(0,528,224)"></polygon>
                  <polygon class="arrowhead" points="64,208 52,202.4 52,213.6" fill="black" transform="rotate(180,56,208)"></polygon>
                  <g class="text">
                    <text x="52" y="52">Attester</text>
                    <text x="404" y="52">Verifier</text>
                    <text x="448" y="52">/</text>
                    <text x="488" y="52">Relying</text>
                    <text x="544" y="52">Party</text>
                    <text x="108" y="100">[loop]</text>
                    <text x="48" y="116">|</text>
                    <text x="536" y="116">|</text>
                    <text x="244" y="132">[Nonce</text>
                    <text x="320" y="132">Generation]</text>
                    <text x="536" y="148">|</text>
                    <text x="504" y="164">generateNonce()</text>
                    <text x="496" y="180">nonce&lt;=</text>
                    <text x="276" y="212">subscribe(nonce,</text>
                    <text x="380" y="212">TpmName,</text>
                    <text x="472" y="212">?PcrSelecion)</text>
                    <text x="88" y="228">{nonce}</text>
                    <text x="176" y="260">[Evidence</text>
                    <text x="260" y="260">Generation</text>
                    <text x="320" y="260">and</text>
                    <text x="384" y="260">Conveyance]</text>
                    <text x="48" y="276">|</text>
                    <text x="164" y="292">generateClaims(attestingEnvironment)</text>
                    <text x="68" y="308">=&gt;</text>
                    <text x="124" y="308">PcrQuotes,</text>
                    <text x="208" y="308">eventLogs</text>
                    <text x="116" y="340">collectClaims(PcrQuotes,</text>
                    <text x="276" y="340">?PcrSelection)</text>
                    <text x="68" y="356">=&gt;</text>
                    <text x="144" y="356">collectedClaims</text>
                    <text x="112" y="388">generateEvidence(nonce,</text>
                    <text x="244" y="388">TpmName,</text>
                    <text x="348" y="388">collectedClaims)</text>
                    <text x="68" y="404">=&gt;</text>
                    <text x="116" y="404">evidence</text>
                    <text x="100" y="436">{evidence,</text>
                    <text x="188" y="436">eventLogs}</text>
                    <text x="248" y="468">[Evidence</text>
                    <text x="332" y="468">Appraisal]</text>
                    <text x="536" y="484">|</text>
                    <text x="460" y="500">appraiseEvidence(evidence,</text>
                    <text x="520" y="516">eventLogs</text>
                    <text x="524" y="532">verInputs)</text>
                    <text x="432" y="548">attestationResult</text>
                    <text x="516" y="548">&lt;=</text>
                    <text x="536" y="548">|</text>
                    <text x="48" y="564">~</text>
                    <text x="536" y="564">~</text>
                    <text x="48" y="580">|</text>
                    <text x="536" y="580">|</text>
                    <text x="116" y="596">[loop]</text>
                    <text x="48" y="612">|</text>
                    <text x="536" y="612">|</text>
                    <text x="148" y="628">[Delta</text>
                    <text x="212" y="628">Evidence</text>
                    <text x="292" y="628">Generation</text>
                    <text x="352" y="628">and</text>
                    <text x="416" y="628">Conveyance]</text>
                    <text x="48" y="644">|</text>
                    <text x="172" y="660">generateClaims(attestingEnvironment)</text>
                    <text x="68" y="676">=&gt;</text>
                    <text x="124" y="676">PcrQuotes,</text>
                    <text x="228" y="676">eventLogsDelta</text>
                    <text x="124" y="708">collectClaims(PcrQuotes,</text>
                    <text x="284" y="708">?PcrSelection)</text>
                    <text x="68" y="724">=&gt;</text>
                    <text x="164" y="724">collectedClaimsDelta</text>
                    <text x="120" y="756">generateEvidence(nonce,</text>
                    <text x="252" y="756">TpmName,</text>
                    <text x="376" y="756">collectedClaimsDelta)</text>
                    <text x="68" y="772">=&gt;</text>
                    <text x="116" y="772">evidence</text>
                    <text x="100" y="804">{evidence,</text>
                    <text x="208" y="804">eventLogsDelta}</text>
                    <text x="212" y="836">[Delta</text>
                    <text x="276" y="836">Evidence</text>
                    <text x="356" y="836">Appraisal]</text>
                    <text x="536" y="852">|</text>
                    <text x="452" y="868">appraiseEvidence(evidence,</text>
                    <text x="492" y="884">eventLogsDelta</text>
                    <text x="516" y="900">verInputs)</text>
                    <text x="432" y="916">attestationResult</text>
                    <text x="516" y="916">&lt;=</text>
                    <text x="48" y="980">|</text>
                    <text x="536" y="980">|</text>
                  </g>
                </svg><a href="#section-3.1.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-yang-subscription-model-for" class="selfRef">YANG Subscription Model for Remote Attestation</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="time-considerations-mapping">
<section id="section-3.1.2">
          <h4 id="name-time-considerations-mapping">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-time-considerations-mapping" class="section-name selfRef">Time Considerations Mapping</a>
          </h4>
<p id="section-3.1.2-1"><span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> defines "Relevant Events over Time" in RATS. The following sequence diagram focusses on matching the defined events with the interactions between the Attester and the Verifying Relying Party.
The action of conveying "collectClaims", which is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15#section-6" class="relref">Section 6</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>, is not defined by <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>.
Therefore, it cannot be matched to a specified event time.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<span id="name-yang-subscription-model-for-"></span><div id="sequence">
<figure id="figure-2">
            <div id="section-3.1.2-2.1">
              <div class="alignLeft art-svg artwork" id="section-3.1.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="800" width="560" viewBox="0 0 560 800" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                  <path d="M 48,112 L 48,160" fill="none" stroke="black"></path>
                  <path d="M 48,192 L 48,208" fill="none" stroke="black"></path>
                  <path d="M 48,256 L 48,432" fill="none" stroke="black"></path>
                  <path d="M 48,496 L 48,512" fill="none" stroke="black"></path>
                  <path d="M 48,544 L 48,560" fill="none" stroke="black"></path>
                  <path d="M 48,608 L 48,784" fill="none" stroke="black"></path>
                  <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                  <path d="M 336,32 L 336,64" fill="none" stroke="black"></path>
                  <path d="M 512,64 L 512,136" fill="none" stroke="black"></path>
                  <path d="M 512,152 L 512,360" fill="none" stroke="black"></path>
                  <path d="M 512,464 L 512,696" fill="none" stroke="black"></path>
                  <path d="M 512,768 L 512,784" fill="none" stroke="black"></path>
                  <path d="M 528,400 L 528,408" fill="none" stroke="black"></path>
                  <path d="M 528,736 L 528,744" fill="none" stroke="black"></path>
                  <path d="M 552,32 L 552,64" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                  <path d="M 336,32 L 552,32" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                  <path d="M 336,64 L 552,64" fill="none" stroke="black"></path>
                  <path d="M 56,144 L 128,144" fill="none" stroke="black"></path>
                  <path d="M 424,144 L 472,144" fill="none" stroke="black"></path>
                  <path d="M 224,304 L 504,304" fill="none" stroke="black"></path>
                  <path d="M 408,320 L 504,320" fill="none" stroke="black"></path>
                  <path d="M 192,336 L 504,336" fill="none" stroke="black"></path>
                  <path d="M 224,640 L 504,640" fill="none" stroke="black"></path>
                  <path d="M 408,656 L 504,656" fill="none" stroke="black"></path>
                  <path d="M 192,672 L 504,672" fill="none" stroke="black"></path>
                  <path class="jump" d="M 512,152 C 506,152 506,136 512,136" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="512,672 500,666.4 500,677.6" fill="black" transform="rotate(0,504,672)"></polygon>
                  <polygon class="arrowhead" points="512,656 500,650.4 500,661.6" fill="black" transform="rotate(0,504,656)"></polygon>
                  <polygon class="arrowhead" points="512,640 500,634.4 500,645.6" fill="black" transform="rotate(0,504,640)"></polygon>
                  <polygon class="arrowhead" points="512,336 500,330.4 500,341.6" fill="black" transform="rotate(0,504,336)"></polygon>
                  <polygon class="arrowhead" points="512,320 500,314.4 500,325.6" fill="black" transform="rotate(0,504,320)"></polygon>
                  <polygon class="arrowhead" points="512,304 500,298.4 500,309.6" fill="black" transform="rotate(0,504,304)"></polygon>
                  <polygon class="arrowhead" points="64,144 52,138.4 52,149.6" fill="black" transform="rotate(180,56,144)"></polygon>
                  <g class="text">
                    <text x="52" y="52">Attester</text>
                    <text x="380" y="52">Verifier</text>
                    <text x="424" y="52">/</text>
                    <text x="464" y="52">Relying</text>
                    <text x="520" y="52">Party</text>
                    <text x="60" y="84">time(VG)</text>
                    <text x="148" y="100">generateClaims(attestingEnvironment)</text>
                    <text x="68" y="116">=&gt;</text>
                    <text x="124" y="116">PcrQuotes,</text>
                    <text x="208" y="116">eventLogs</text>
                    <text x="276" y="148">establish-subscription(&lt;attestation&gt;</text>
                    <text x="492" y="148">time</text>
                    <text x="528" y="148">NS)</text>
                    <text x="100" y="180">collectClaims(PcrQuotes,</text>
                    <text x="260" y="180">?PcrSelection)</text>
                    <text x="68" y="196">=&gt;</text>
                    <text x="144" y="196">collectedClaims</text>
                    <text x="60" y="228">time(EG)</text>
                    <text x="96" y="244">generateEvidence(nonce,</text>
                    <text x="248" y="244">PcrSelection,</text>
                    <text x="372" y="244">collectedClaims)</text>
                    <text x="68" y="260">=&gt;</text>
                    <text x="180" y="260">SignedPcrEvidence(nonce,</text>
                    <text x="336" y="260">PcrSelection)</text>
                    <text x="68" y="276">=&gt;</text>
                    <text x="196" y="276">LogEvidence(collectedClaims)</text>
                    <text x="136" y="308">--filter(&lt;pcr-extend&gt;</text>
                    <text x="136" y="324">--&lt;tpm12-attestation&gt;</text>
                    <text x="236" y="324">or</text>
                    <text x="328" y="324">&lt;tpm20-attestation&gt;</text>
                    <text x="120" y="340">--&lt;log-retrieval&gt;</text>
                    <text x="496" y="372">time(RG,RA)</text>
                    <text x="428" y="388">appraiseEvidence(evidence,</text>
                    <text x="488" y="404">eventLogs</text>
                    <text x="492" y="420">verInputs)</text>
                    <text x="408" y="436">attestationResult</text>
                    <text x="492" y="436">&lt;=</text>
                    <text x="512" y="436">|</text>
                    <text x="48" y="452">~</text>
                    <text x="512" y="452">~</text>
                    <text x="64" y="468">time(VG')</text>
                    <text x="148" y="484">generateClaims(attestingEnvironment)</text>
                    <text x="68" y="500">=&gt;</text>
                    <text x="124" y="500">PcrQuotes,</text>
                    <text x="228" y="500">eventLogsDelta</text>
                    <text x="100" y="532">collectClaims(PcrQuotes,</text>
                    <text x="260" y="532">?PcrSelection)</text>
                    <text x="68" y="548">=&gt;</text>
                    <text x="164" y="548">collectedClaimsDelta</text>
                    <text x="64" y="580">time(EG')</text>
                    <text x="96" y="596">generateEvidence(nonce,</text>
                    <text x="228" y="596">TpmName,</text>
                    <text x="352" y="596">collectedClaimsDelta)</text>
                    <text x="68" y="612">=&gt;</text>
                    <text x="116" y="612">evidence</text>
                    <text x="136" y="644">--filter(&lt;pcr-extend&gt;</text>
                    <text x="136" y="660">--&lt;tpm12-attestation&gt;</text>
                    <text x="236" y="660">or</text>
                    <text x="328" y="660">&lt;tpm20-attestation&gt;</text>
                    <text x="120" y="676">--&lt;log-retrieval&gt;</text>
                    <text x="496" y="708">time(RG,RA)</text>
                    <text x="428" y="724">appraiseEvidence(evidence,</text>
                    <text x="488" y="740">eventLogs</text>
                    <text x="492" y="756">verInputs)</text>
                    <text x="408" y="772">attestationResult</text>
                    <text x="492" y="772">&lt;=</text>
                  </g>
                </svg><a href="#section-3.1.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-yang-subscription-model-for-" class="selfRef">YANG Subscription Model for Remote Attestation</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-3.1.2-3.1">
              <p id="section-3.1.2-3.1.1">time(VG,RG,RA) are identical to the corresponding time definitions from <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span>.<a href="#section-3.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.2-3.2">
              <p id="section-3.1.2-3.2.1">time(VG',RG',RA') are subsequent instances of the corresponding times from Figure 5 in <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span>.<a href="#section-3.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.2-3.3">
              <p id="section-3.1.2-3.3.1">time(NS) – the subscriber generates a nonce and makes an <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> &lt;establish-subscription&gt; request based on a nonce. This request also includes the augmentations defined in this document's YANG model. Key subscription RPC parameters include:<a href="#section-3.1.2-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2-3.3.2.1">
                  <p id="section-3.1.2-3.3.2.1.1">the nonce,<a href="#section-3.1.2-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2-3.3.2.2">
                  <p id="section-3.1.2-3.3.2.2.1">a set of PCRs of interest which the Relying Party or Verifier wants to be appraised, and<a href="#section-3.1.2-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2-3.3.2.3">
                  <p id="section-3.1.2-3.3.2.3.1">an optional filter which can reduce the logged events on the &lt;attestation&gt; stream pushed to the Verifier.<a href="#section-3.1.2-3.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-3.1.2-3.4">
              <p id="section-3.1.2-3.4.1">time(EG) – an initial response of Evidence is returned to the Verifier. This includes:<a href="#section-3.1.2-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2-3.4.2.1">
                  <p id="section-3.1.2-3.4.2.1.1">a replay of filtered log entries which have extended into a PCR of interest since boot are sent in the &lt;pcr-extend&gt; notification, and<a href="#section-3.1.2-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2-3.4.2.2">
                  <p id="section-3.1.2-3.4.2.2.1">a signed TPM quote that contains at least the PCRs from the &lt;establish-subscription&gt; RPC are included in a &lt;tpm12-attestation&gt; or &lt;tpm20-attestation&gt;). This quote must have included the nonce provided at time(NS).<a href="#section-3.1.2-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-3.1.2-3.5">
              <p id="section-3.1.2-3.5.1">time(VG',EG') – this occurs when a PCR is extended subsequent to time(EG). Immediately after the extension, the following information needs to be pushed to the Verifier:<a href="#section-3.1.2-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2-3.5.2.1">
                  <p id="section-3.1.2-3.5.2.1.1">any values extended into a PCR of interest,<a href="#section-3.1.2-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2-3.5.2.2">
                  <p id="section-3.1.2-3.5.2.2.1">a signed TPM Quote showing the result the PCR extension, and<a href="#section-3.1.2-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2-3.5.2.3">
                  <p id="section-3.1.2-3.5.2.3.1">and a handle (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15#section-6" class="relref">Section 6</a> of [<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>), which is either the initially received nonce or a more recently received Epoch ID (see <span><a href="https://rfc-editor.org/rfc/rfc9334#section-10.3" class="relref">Section 10.3</a> of [<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) that contains a new nonce or equivalent qualified data.<a href="#section-3.1.2-3.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.1.2-4">One way to acquire a new time synchronisation that allows for the reuse of the initially received nonce as a fresh handle is elaborated on in <a href="#freshness-handles" class="auto internal xref">Section 3.2</a> below.<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="freshness-handles">
<section id="section-3.2">
        <h3 id="name-continuously-verifying-fres">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-continuously-verifying-fres" class="section-name selfRef">Continuously Verifying Freshness</a>
        </h3>
<p id="section-3.2-1">As there is no new Verifier nonce provided at time(EG'), it is important to validate the freshness of TPM Quotes which are delivered at that time.  The method of doing this verification will vary based on the capabilities of the TPM cryptoprocessor used.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="tpm-12-quote">
<section id="section-3.2.1">
          <h4 id="name-tpm-12-quote">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-tpm-12-quote" class="section-name selfRef">TPM 1.2 Quote</a>
          </h4>
<p id="section-3.2.1-1">The <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> notification format includes the &lt;eventTime&gt; object.  This can be used to determine the amount of time subsequent to the initial subscription each notification was sent.  However this time is not part of the signed results which are returned from the Quote, and therefore is not trustworthy as objects returned in the Quote.  Therefore a Verifier <span class="bcp14">MUST</span> periodically issue a new nonce, and receive this nonce within a TPM quote response in order to ensure the freshness of the results.  This can be done using the &lt;tpm12-challenge-response-attestation&gt; RPC from <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tpm-2-quote">
<section id="section-3.2.2">
          <h4 id="name-tpm-2-quote">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-tpm-2-quote" class="section-name selfRef">TPM 2 Quote</a>
          </h4>
<p id="section-3.2.2-1">When the Attester includes a TPM2-compliant cryptoprocessor, internal time-related counters are included within the signed TPM Quote.  By including an initial nonce in the <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> subscription request, fresh values for these counters are pushed as part of the first TPM Quote returned to the Verifier. As shown by <span>[<a href="#I-D.birkholz-rats-tuda" class="cite xref">I-D.birkholz-rats-tuda</a>]</span>, subsequent TPM Quotes delivered to the Verifier can be appraised for freshness based on the predictable incrementing of these time-related counters.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The relevant internal time-related counters defined within <span>[<a href="#TPM2.0" class="cite xref">TPM2.0</a>]</span> can be seen within &lt;tpms-clock-info&gt;.   These counters include the &lt;clock&gt;, &lt;reset-counter&gt;, and &lt;restart-counter&gt; objects.  The rules for appraising these objects are as follows:<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-3.1">
              <p id="section-3.2.2-3.1.1">If the &lt;clock&gt; has incremented for no more than the same duration as both the &lt;eventTime&gt; and the Verifier's internal time since the initial time(EG) and any previous time(EG'), then the TPM Quote may be considered fresh. Note that <span>[<a href="#TPM2.0" class="cite xref">TPM2.0</a>]</span> allows for +/- 15% clock drift.  However many chips significantly improve on this maximum drift.  If available, chip specific maximum drifts <span class="bcp14">SHOULD</span> be considered during the appraisal process.<a href="#section-3.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.2-3.2">
              <p id="section-3.2.2-3.2.1">If the &lt;reset-counter&gt;, &lt;restart-counter&gt; has incremented.  The existing subscription <span class="bcp14">MUST</span> be terminated, and a new &lt;establish-subscription&gt; <span class="bcp14">SHOULD</span> be generated.<a href="#section-3.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.2-3.3">
              <p id="section-3.2.2-3.3.1">If a TPM Quote on any subscribed PCR has not been pushed to the Verifier for a duration of an Attester defined heartbeat interval, then a new TPM Quote notification should be sent to the Verifier.  This may often be the case, as certain PCRs might be infrequently updated.<a href="#section-3.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="section-3.2.2-4">
            <div class="alignLeft art-svg artwork" id="section-3.2.2-4.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="208" width="520" viewBox="0 0 520 208" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 48,96 L 48,112" fill="none" stroke="black"></path>
                <path d="M 48,176 L 48,192" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 296,32 L 296,64" fill="none" stroke="black"></path>
                <path d="M 464,72 L 464,112" fill="none" stroke="black"></path>
                <path d="M 464,144 L 464,192" fill="none" stroke="black"></path>
                <path d="M 512,32 L 512,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                <path d="M 296,32 L 512,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                <path d="M 296,64 L 512,64" fill="none" stroke="black"></path>
                <path d="M 216,96 L 456,96" fill="none" stroke="black"></path>
                <path d="M 216,176 L 456,176" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="464,176 452,170.4 452,181.6" fill="black" transform="rotate(0,456,176)"></polygon>
                <polygon class="arrowhead" points="464,96 452,90.4 452,101.6" fill="black" transform="rotate(0,456,96)"></polygon>
                <g class="text">
                  <text x="52" y="52">Attester</text>
                  <text x="336" y="52">Relying</text>
                  <text x="392" y="52">Party</text>
                  <text x="424" y="52">/</text>
                  <text x="468" y="52">Verifier</text>
                  <text x="80" y="84">time(VG',EG')</text>
                  <text x="132" y="100">-&lt;tpm20-attestation&gt;</text>
                  <text x="344" y="116">:</text>
                  <text x="48" y="132">~</text>
                  <text x="304" y="132">Heartbeat</text>
                  <text x="380" y="132">interval</text>
                  <text x="464" y="132">~</text>
                  <text x="48" y="148">|</text>
                  <text x="344" y="148">:</text>
                  <text x="64" y="164">time(EG')</text>
                  <text x="344" y="164">:</text>
                  <text x="132" y="180">-&lt;tpm20-attestation&gt;</text>
                </g>
              </svg><a href="#section-3.2.2-4.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="attestationstream">
<section id="section-4">
      <h2 id="name-remote-attestation-event-st">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-remote-attestation-event-st" class="section-name selfRef">Remote Attestation Event Stream</a>
      </h2>
<p id="section-4-1">The &lt;attestation&gt; Event Stream is an <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> compliant Event Stream which is defined within this section and within the YANG Module of <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>. This Event Stream contains YANG notifications which carry Evidence to assists a Verifier in appraising the Trustworthiness Level of an Attester. Data Nodes within <a href="#configuring" class="auto internal xref">Section 4.6</a> allow the configuration of this Event Stream's contents on an Attester.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This &lt;attestation&gt; Event Stream may only be exposed on Attesters supporting <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span>. As with <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span>, it is up to the Verifier to understand which types of cryptoprocessors and keys are acceptable.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="subscription-to-the-attestation-event-stream">
<section id="section-4.1">
        <h3 id="name-subscription-to-the-attesta">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-subscription-to-the-attesta" class="section-name selfRef">Subscription to the &lt;attestation&gt; Event Stream</a>
        </h3>
<p id="section-4.1-1">To establish a subscription to an Attester in a way which provides provably fresh Evidence, initial randomness must be provided to the Attester. This is done via the augmentation of a &lt;nonce-value&gt; into <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> the &lt;establish-subscription&gt; RPC. Additionally, a Verifier must ask for PCRs of interest from a platform.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
  augment /sn:establish-subscription/sn:input:
    +---w nonce-value    binary
    +---w pcr-index*     tpm:pcr
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">The result of the subscription will be that passing of the following information:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-4">
<li id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">&lt;tpm12-attestation&gt; and &lt;tpm20-attestation&gt; notifications which include the provided &lt;nonce-value&gt;.  These attestation notifications <span class="bcp14">MUST</span> at least include all the &lt;pcr-indicies&gt; requested in the RPC.<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-4.2">
            <p id="section-4.1-4.2.1">a series of &lt;pcr-extend&gt; notifications which reference the requested PCRs on all TPM based cryptoprocessors on the Attester.<a href="#section-4.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.1-4.3">
            <p id="section-4.1-4.3.1">&lt;tpm12-attestation&gt; and &lt;tpm20-attestation&gt; notifications generated within a few seconds of the &lt;pcr-extend&gt; notifications.  These attestation notifications <span class="bcp14">MUST</span> at least include any PCRs extended.<a href="#section-4.1-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.1-5">If the Verifier does not want to see the logged extend operations for all PCRs available from an Attester, an Event Stream Filter should be applied.  This filter will remove Evidence from any PCRs which are not interesting to the Verifier.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replaying-a-history-of-previous-tpm-extend-operations">
<section id="section-4.2">
        <h3 id="name-replaying-a-history-of-prev">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-replaying-a-history-of-prev" class="section-name selfRef">Replaying a history of previous TPM extend operations</a>
        </h3>
<p id="section-4.2-1">Unless it is relying on Known Good Values, a Verifier will need to acquire a history of PCR extensions since the Attester has been booted.  This history may be requested from the Attester as part of the &lt;establish-subscription&gt; RPC.  This request is accomplished by placing a very old &lt;replay-start-time&gt; within the original RPC request.  As the very old &lt;replay-start-time&gt; will pre-date the time of Attester boot, a &lt;replay-start-time-revision&gt; will be returned in the &lt;establish-subscription&gt; RPC response, indicating when the Attester booted.  Immediately following the response (and before the notifications above)  one or more &lt;pcr-extend&gt; notifications which document all extend operations which have occurred for the requested PCRs since boot will be sent.  Many extend operations to a single PCR index on a single TPM <span class="bcp14">SHOULD</span> be included within a single notification.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Note that if a Verifier has a partial history of extensions, the &lt;replay-start-time&gt; can be adjusted so that known extensions are not forwarded.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The end of this history replay will be indicated with the <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> &lt;replay-completed&gt; notification.  For more on this sequence, see Section 2.4.2.1 of <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">After the &lt;replay-complete&gt; notification is provided, a TPM Quote will be requested and the result passed to the Verifier via a &lt;tpm12-attestation&gt; and &lt;tpm20-attestation&gt; notification.  If there have been any additional extend operations which have changed a subscribed PCR value in this quote, these <span class="bcp14">MUST</span> be pushed to the Verifier before the &lt;tpm12-attestation&gt; and &lt;tpm20-attestation&gt; notification.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">At this point the Verifier has sufficient Evidence appraise the reported extend operations for each PCR, as well compare the expected value of the PCR value against that signed by the TPM.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div id="tpm2-heartbeat">
<section id="section-4.2.1">
          <h4 id="name-tpm2-heartbeat">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-tpm2-heartbeat" class="section-name selfRef">TPM2 Heartbeat</a>
          </h4>
<p id="section-4.2.1-1">For TPM2, make sure that every requested PCR is sent within an &lt;tpm20-attestation&gt; no less frequently than once per heartbeat interval.   This <span class="bcp14">MAY</span> be done with a single &lt;tpm20-attestation&gt; notification that includes all requested PCRs every heartbeat interval.  This <span class="bcp14">MAY</span> be done with several &lt;tpm20-attestation&gt; notifications at different times during that heartbeat interval.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="yang-notifications-placed-on-the-attestation-event-stream">
<section id="section-4.3">
        <h3 id="name-yang-notifications-placed-o">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-yang-notifications-placed-o" class="section-name selfRef">YANG notifications placed on the &lt;attestation&gt; Event Stream</a>
        </h3>
<div id="pcr-extend">
<section id="section-4.3.1">
          <h4 id="name-pcr-extend">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-pcr-extend" class="section-name selfRef">pcr-extend</a>
          </h4>
<p id="section-4.3.1-1">This notification documents when a subscribed PCR is extended within a single TPM cryptoprocessor.  It <span class="bcp14">SHOULD</span> be emitted no less than the &lt;marshalling-period&gt; after the PCR is first extended.  (The reason for the marshalling is that it is quite possible that multiple extensions to the same PCR have been made in quick succession, and these should be reflected in the same notification.)  This notification <span class="bcp14">MUST</span> be emitted prior to a &lt;tpm12-attestation&gt; or &lt;tpm20-attestation&gt; notification which has included and signed the results of any specific PCR extension.   If pcr extending events occur during the generation of the &lt;tpm12-attestation&gt; or &lt;tpm20-attestation&gt; notification, the marshalling period <span class="bcp14">MUST</span> be extended so that a new &lt;pcr-extend&gt; is not sent until the corresponding notifications have been sent.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-2">
<pre>
+---n pcr-extend
   +--ro certificate-name     certificate-name-ref
   +--ro pcr-index-changed*   tpm:pcr
   +--ro attested-event* []
      +--ro attested-event
         +--ro extended-with             binary
         +--ro (event-details)?
            +--:(bios-event-log) {tpm:bios}?
            |  +--ro bios-event-entry* [event-number]
            |     +--ro event-number    uint32
            |     +--ro event-type?     uint32
            |     +--ro pcr-index?      pcr
            |     +--ro digest-list* []
            |     |  +--ro hash-algo?   identityref
            |     |  +--ro digest*      binary
            |     +--ro event-size?     uint32
            |     +--ro event-data*     uint8
            +--:(ima-event-log) {tpm:ima}?
            |  +--ro ima-event-entry* [event-number]
            |     +--ro event-number               uint64
            |     +--ro ima-template?              string
            |     +--ro filename-hint?             string
            |     +--ro filedata-hash?             binary
            |     +--ro filedata-hash-algorithm?   string
            |     +--ro template-hash-algorithm?   string
            |     +--ro template-hash?             binary
            |     +--ro pcr-index?                 pcr
            |     +--ro signature?                 binary
            +--:(netequip-boot-event-log) {tpm:netequip_boot}?
               +--ro boot-event-entry* [event-number]
                  +--ro event-number               uint64
                  +--ro ima-template?              string
                  +--ro filename-hint?             string
                  +--ro filedata-hash?             binary
                  +--ro filedata-hash-algorithm?   string
                  +--ro template-hash-algorithm?   string
                  +--ro template-hash?             binary
                  +--ro pcr-index?                 pcr
                  +--ro signature?                 binary
</pre><a href="#section-4.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-3">Each &lt;pcr-extend&gt; <span class="bcp14">MUST</span> include one or more values being extended into the PCR.   These are passed within the &lt;extended-with&gt; object.  For each extension, details of the event <span class="bcp14">SHOULD</span> be provided within the &lt;event-details&gt; object.
The format of any included &lt;event-details&gt; is identified by the &lt;event-type&gt;.  This document includes two YANG structures which may be inserted into the &lt;event-details&gt;.  These two structures are: &lt;ima-event-log&gt; and &lt;bios-event-log&gt;.  Implementations wanting to provide additional documentation of a type of PCR extension may choose to define additional YANG structures which can be placed into &lt;event-details&gt;.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tpm12-attestation">
<section id="section-4.3.2">
          <h4 id="name-tpm12-attestation">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-tpm12-attestation" class="section-name selfRef">tpm12-attestation</a>
          </h4>
<p id="section-4.3.2-1">This notification contains an instance of a TPM1.2 style signed cryptoprocessor measurement. It is supplemented by Attester information which is not signed. This notification is generated and emitted from an Attester when at least one PCR identified within the subscribed &lt;pcr-indices&gt; has changed from the previous &lt;tpm12-attestation&gt; notification.  This notification <span class="bcp14">MUST NOT</span> include the results of any PCR extensions not previously reported by a &lt;pcr-extend&gt;.  This notification <span class="bcp14">SHOULD</span> be emitted as soon as a TPM Quote can extract the latest PCR hashed values.  This notification <span class="bcp14">MUST</span> be emitted prior to a subsequent &lt;pcr-extend&gt;.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.2-2">
<pre>
    +---n tpm12-attestation {taa:TPM12}?
       +--ro certificate-name       tpm:certificate-name-ref
       +--ro up-time?               uint32
       +--ro TPM_QUOTE2?            binary
       +--ro TPM12-hash-algo?       identityref
       +--ro unsigned-pcr-values* []
          +--ro pcr-index*   tpm:pcr
          +--ro pcr-value*   binary
</pre><a href="#section-4.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-3">All YANG objects above are defined within <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.  The &lt;tpm12-attestation&gt; is not replayable.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tpm20-attestation">
<section id="section-4.3.3">
          <h4 id="name-tpm20-attestation">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-tpm20-attestation" class="section-name selfRef">tpm20-attestation</a>
          </h4>
<p id="section-4.3.3-1">This notification contains an instance of TPM2 style signed cryptoprocessor measurements. It is supplemented by Attester information which is not signed. This notification is generated at two points in time:<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.3-2.1">
              <p id="section-4.3.3-2.1.1">every time at least one PCR has changed from a previous tpm20-attestation. In this case, the notification <span class="bcp14">SHOULD</span> be emitted within 10 seconds of the corresponding &lt;pcr-extend&gt; being sent:<a href="#section-4.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.3.3-2.2">
              <p id="section-4.3.3-2.2.1">after a locally configurable minimum heartbeat period since a previous tpm20-attestation was sent.<a href="#section-4.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="alignLeft art-text artwork" id="section-4.3.3-3">
<pre>
    +---n tpm20-attestation {taa:TPM20}?
       +--ro certificate-name       tpm:certificate-name-ref
       +--ro TPMS_QUOTE_INFO        binary
       +--ro quote-signature?       binary
       +--ro up-time?               uint32
       +--ro unsigned-pcr-values* []
          +--ro TPM20-hash-algo?   identityref
          +--ro pcr-values* [pcr-index]
             +--ro pcr-index    pcr
             +--ro pcr-value?   binary
</pre><a href="#section-4.3.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3.3-4">All YANG objects above are defined within <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>.  The &lt;tpm20-attestation&gt; is not replayable.<a href="#section-4.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="filtering-evidence-at-the-attester">
<section id="section-4.4">
        <h3 id="name-filtering-evidence-at-the-a">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-filtering-evidence-at-the-a" class="section-name selfRef">Filtering Evidence at the Attester</a>
        </h3>
<p id="section-4.4-1">It can be useful <em>not</em> to receive all Evidence related to a PCR.  An example of this is would be a when a Verifier maintains known good values of a PCR.  In this case, it is not necessary to send each extend operation.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">To accomplish this reduction, when an RFC8639 &lt;establish-subscription&gt; RPC is sent, a &lt;stream-filter&gt; as per RFC8639, Section 2.2 can be set to discard a &lt;pcr-extend&gt;  notification when the &lt;pcr-index-changed&gt; is uninteresting to the verifier.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replaying-previous-pcr-extend-events">
<section id="section-4.5">
        <h3 id="name-replaying-previous-pcr-exte">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-replaying-previous-pcr-exte" class="section-name selfRef">Replaying previous PCR Extend events</a>
        </h3>
<p id="section-4.5-1">To verify the value of a PCR, a Verifier must either know that the value is a "known good" value (see Section 2.3.3 of <span>[<a href="#KGV" class="cite xref">KGV</a>]</span>) or be able to reconstruct the hash value by viewing all the PCR-Extends since the Attester rebooted. Wherever a hash reconstruction might be needed, the &lt;attestation&gt; Event Stream <span class="bcp14">MUST</span> support the RFC8639 &lt;replay&gt; feature. Through the &lt;replay&gt; feature, it is possible for a Verifier to retrieve and sequentially hash all of the PCR extending events since an Attester booted. And thus, the Verifier has access to all the evidence needed to verify a PCR's current value.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configuring">
<section id="section-4.6">
        <h3 id="name-configuring-the-attestation">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-configuring-the-attestation" class="section-name selfRef">Configuring the &lt;attestation&gt; Event Stream</a>
        </h3>
<p id="section-4.6-1"><a href="#attestationconfig" class="auto internal xref">Figure 3</a> is tree diagram which exposes the operator configurable elements of the &lt;attestation&gt; Event Stream. This allows an Attester to select what information should be available on the stream. A fetch operation also allows an external device such as a Verifier to understand the current configuration of stream.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">Almost all YANG objects below are defined via reference from <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span>. There is one object which is new with this model however. &lt;tpm2-heartbeat&gt; defines the maximum amount of time which should pass before a subscriber to the Event Stream should get a &lt;tpm20-attestation&gt; notification from devices which contain a TPM2.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<span id="name-configuring-the-attestation-"></span><div id="attestationconfig">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.6-3.1">
<pre>
  augment /tpm:rats-support-structures:
    +--rw tras:marshalling-period?                  uint8
    +--rw tras:tpm12-subscribed-signature-scheme?
    |   -&gt; ../tpm:attester-supported-algos/tpm12-asymmetric-signing
    |      {taa:TPM12}?
    +--rw tras:tpm20-subscribed-signature-scheme?
    |   -&gt; ../tpm:attester-supported-algos/tpm20-asymmetric-signing
    |      {taa:TPM20}?
    +--rw tras:tpm20-subscription-heartbeat?        uint16
           {taa:TPM20}?

  augment /tpm:rats-support-structures/tpm:tpms:
     +--rw tras:subscription-aik?        tpm:certificate-name-ref
     +--rw (tras:subscribable)?
        +--:(tras:tpm12-stream) {taa:tpm12}?
        |  +--rw tras:tpm12-hash-algo?   identityref
        |  +--rw tras:tpm12-pcr-index*   tpm:pcr
        +--:(tras:tpm20-stream) {taa:tpm20}?
           +--rw tras:tpm20-hash-algo?   identityref
           +--rw tras:tpm20-pcr-index*   tpm:pcr
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-configuring-the-attestation-" class="selfRef">Configuring the \&lt;attestation\&gt; Event Stream</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="YANG-Module">
<section id="section-5">
      <h2 id="name-yang-module">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-yang-module" class="section-name selfRef">YANG Module</a>
      </h2>
<p id="section-5-1">This YANG module imports modules from <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> and <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>.  It is also work-in-progress.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div class="breakable lang-YANG sourcecode" id="section-5-2">
<pre>
&lt;CODE BEGINS&gt; ietf-tpm-remote-attestation-stream@2025-01-06.yang
module ietf-tpm-remote-attestation-stream {
  yang-version 1.1;
  namespace
     "urn:ietf:params:xml:ns:yang:ietf-tpm-remote-attestation-stream";
  prefix tras;

  import ietf-subscribed-notifications {
    prefix sn;
    reference
      "RFC 8639: Subscription to YANG Notifications";
  }
  import ietf-tpm-remote-attestation {
    prefix tpm;
    reference
      "draft-ietf-rats-yang-tpm-charra";
  }
  import ietf-tcg-algs {
    prefix taa;
  }

  organization "IETF";
  contact
    "WG Web:   &lt;http://tools.ietf.org/wg/rats/&gt;
     WG List:  &lt;mailto:rats@ietf.org&gt;

     Editor:   Eric Voit
               &lt;mailto:evoit@cisco.com&gt;";

  description
    "This module contains YANG specification for subscribing
     to attestation streams which contain events that have
     been generated by TPM chips or equivalent hardware
     implementations that include the protected capabilities
     as provided by TPMs.

     Copyright (c) 2024 IETF Trust and the persons identified
     as authors of the code. All rights reserved.

     Redistribution and use in source and binary forms, with
     or without modification, is permitted pursuant to, and
     subject to the license terms contained in, the Simplified
     BSD License set forth in Section 4.c of the IETF Trust's
     Legal Provisions Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC XXXX
     (https://www.rfc-editor.org/info/rfcXXXX); see the RFC
     itself for full legal notices.";

  revision 2024-07-06 {
    description
      "Initial version.";
    reference
      "draft-ietf-rats-network-device-subscription";
  }

  /*
   * IDENTITIES
   */

  identity pcr-unsubscribable {
    base sn:establish-subscription-error;
    description
      "Requested PCR is unsubscribable by the Attester.";
  }


  /*
   * Groupings
   */

  grouping heartbeat {
    description
      "Allows an Attester to push verifiable, current TPM PCR values
      even when there have been no recent changes to PCRs.";
    leaf tpm20-subscription-heartbeat {
      type uint16;
      units "seconds";
      description
        "Number of seconds before the Attestation stream should send
        a new notification with a fresh quote.  This allows
        confirmation that the PCR values haven't changed since the
        last tpm20-attestation.";
    }
  }


  /*
   * RPCs
   */

  augment "/sn:establish-subscription/sn:input" {
    when 'derived-from-or-self(sn:stream, "attestation")';
    description
      "This augmentation adds a nonce to as a subscription parameters
       that apply specifically to datastore updates to RPC input.";
    uses tpm:nonce;
    leaf-list pcr-index {
      type tpm:pcr;
      min-elements 1;
      description
        "The numbers/indexes of the PCRs. This will act as a filter
        for the subscription so that 'tpm-extend' notifications
        related to non-requested PCRs will not be sent to a
        subscriber.";
    }
  }

  /*
   * NOTIFICATIONS
   */

  notification pcr-extend {
    description
      "This notification indicates that one or more PCRs have been
      extended within a TPM based cryptoprocessor.  In less than the
      'marshalling-period', it MUST be followed with either a
      corresponding tpm12-attestation or tpm20-attestation
      notification which exposes the result of the PCRs updated.";
    uses tpm:certificate-name-ref;
    leaf-list pcr-index-changed {
      type tpm:pcr;
      min-elements 1;
      description
        "The number of each PCR extended.  This list MUST contain the
        set of PCRs descibed within the event log details.  This leaf
        can be derived from the list of attested events, but exposing
        it here allows for easy filtering of the notifications of
        interest to a verifier.";
    }
    list attested-event {
      description
        "A set of events which extended an Attester PCR.  The
        sequence of elements represented in list must match the
        sequence of events placed into the TPM's PCR.";
      container attested-event {
        description
          "An instance of an event which extended an Attester PCR";
        leaf extended-with {
          type binary;
          mandatory true;
          description
            "Information extending the PCR.";
        }
        choice event-details {
          description
            "Contains the event happened the Attester thought
            was worthy of recording in a PCR.

            choices are of types defined by the identityref
            base tpm:attested_event_log_type";
          case bios-event-log {
            if-feature "tpm:bios";
            description
              "BIOS/UEFI event log format";
            uses tpm:bios-event-log;
          }
          case ima-event-log {
            if-feature "tpm:ima";
            description
              "IMA event log format";
            uses tpm:ima-event-log;
          }
          case netequip-boot-event-log {
            if-feature "tpm:netequip_boot";
            description
              "IMA event log format";
            uses tpm:network-equipment-boot-event-log;
          }
        }
      }
    }
  }

  notification tpm12-attestation {
    if-feature "taa:tpm12";
    description
      "Contains an instance of TPM1.2 style signed cryptoprocessor
      measurements.  It is supplemented by unsigned Attester
      information.";
    leaf certificate-name {
      type tpm:certificate-name-ref;
      mandatory true;
      description
        "Allows a TPM quote to be associated with a certificate.";
    }
    uses tpm:tpm12-attestation;
    uses tpm:tpm12-hash-algo;
    list unsigned-pcr-values {
      description
        "Allows notifications to be filtered by PCR number or
        PCR value based on via YANG related mechanisms such as PATH.
        This is done without requiring the filtering structure to be
        applied against TCG structured data.";
      leaf-list pcr-index {
        type tpm:pcr;
        min-elements 1;
        description
          "PCR index number.";
      }
      leaf-list pcr-value {
        type binary;
        description
          "PCR value in a sequence which matches to the
          'pcr-index'.";
      }
    }
  }

  notification tpm20-attestation {
    if-feature "taa:tpm20";
    description
      "Contains an instance of TPM2 style signed cryptoprocessor
      measurements.  It is supplemented by unsigned Attester
      information.";
    leaf certificate-name {
      type tpm:certificate-name-ref;
      mandatory true;
      description
        "Allows a TPM quote to be associated with a certificate.";
    }
    uses tpm:tpm20-attestation {
      description
        "Provides the attestation info.  Also ensures PCRs can be
        XPATH filtered by refining the unsigned data so that it
        appears.";
      refine unsigned-pcr-values {
        min-elements 1;
      }
      refine unsigned-pcr-values/pcr-values {
        min-elements 1;
      }
    }
  }


  /*
   * DATA NODES
   */

  augment "/tpm:rats-support-structures" {
    description
      "Defines platform wide 'attestation' stream subscription
      parameters.";
    leaf marshalling-period {
      type uint8;
      default 5;
      description
        "The maximum number of seconds between the time an event
        extends a PCR, and the 'tpm-extend' notification which
        reports it to a subscribed Verifier.  This period allows
        multiple extend operations bundled together and handled as a
        group.";
    }
    leaf tpm12-subscribed-signature-scheme {
      if-feature "taa:tpm12";
      type leafref {
        path "../tpm:attester-supported-algos" +
               "/tpm:tpm12-asymmetric-signing";
      }
      description
        "A single signature-scheme which will be used to sign the
        evidence from a TPM 1.2. which is then placed onto the
        'attestation' event stream.";
    }
    leaf tpm20-subscribed-signature-scheme {
      if-feature "taa:tpm20";
      type leafref {
        path "../tpm:attester-supported-algos" +
               "/tpm:tpm20-asymmetric-signing";
      }
      description
        "A single signature-scheme which will be used to sign the
        evidence from a TPM 2.0. which is then placed onto the
        'attestation' event stream.";
    }
    uses heartbeat{
      if-feature "taa:tpm20";
    }
  }

  augment "/tpm:rats-support-structures/tpm:tpms" {
    description
      "Allows the configuration 'attestation' stream parameters for a
      TPM.";
    leaf subscription-aik {
      type tpm:certificate-name-ref;
      description
        "Identifies the certificate-name associated with the
        notifications in the 'attestation' stream.";
    }
    choice subscribable {
      config true;
      description
        "Indicates that the set of notifications which comprise the
        'attestation' event stream can be modified or tuned by a
        network administrator.";
      case tpm12-stream {
        if-feature "taa:tpm12";
        description
          "Configuration elements for a TPM1.2 event stream.";
        uses tpm:tpm12-hash-algo;
        leaf-list tpm12-pcr-index {
          type tpm:pcr;
          description
            "The numbers/indexes of the PCRs which can be
            subscribed.";
        }
      }
      case tpm20-stream {
        if-feature "taa:tpm20";
        description
          "Configuration elements for a TPM2.0 event stream.";
        uses tpm:tpm20-hash-algo;
        leaf-list tpm20-pcr-index {
          type tpm:pcr;
          description
            "The numbers/indexes of the PCRs which can be
            subscribed.";
        }
      }
    }
  }
}
&lt;CODE ENDS&gt;
</pre><a href="#section-5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="otherstreams">
<section id="section-6">
      <h2 id="name-event-streams-for-conceptua">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-event-streams-for-conceptua" class="section-name selfRef">Event Streams for Conceptual Messages</a>
      </h2>
<p id="section-6-1">Analogous to the <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> compliant &lt;attestation&gt; Event Stream for the conveyance of remote attestation Evidence as defined in Section <a href="#attestationstream" class="auto internal xref">Section 4</a>, additional Event Streams can be defined for this YANG augment. Additional Event Streams require separate YANG augment specifications that provide the Event Stream definition and optionally a content format definition either via subscriptions to YANG datastores or dedicated YANG Notifications. It is possible to use either YANG subscription methods to other YANG modules for RATS Conceptual Messages or to define Event Streams for other none-YANG-modeled data. In the context of RATS Conceptual Messages, both options <span class="bcp14">MUST</span> be a specified via YANG augments to this specification.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">The Privacy Considerations of <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span> apply.
Additionally, the Security Considerations from <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span> outline how internal structures or capabilities about the system can leak, which can have an impact in personally identifiable information (PII).<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">The Security Considerations of <span>[<a href="#RFC9684" class="cite xref">RFC9684</a>]</span> and <span>[<a href="#RFC9683" class="cite xref">RFC9683</a>]</span> apply.
Additionally, the Security Requirements from <span><a href="https://rfc-editor.org/rfc/rfc7923#section-4.2.5" class="relref">Section 4.2.5</a> of [<a href="#RFC7923" class="cite xref">RFC7923</a>]</span> and the Security Considerations from <span><a href="https://rfc-editor.org/rfc/rfc7923#section-5" class="relref">Section 5</a> of [<a href="#RFC7923" class="cite xref">RFC7923</a>]</span> apply.
<span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span> illustrates specific Security Considerations concerning YANG Notifications for Datastore Updates. For example, it provides guidance on identifying sensitive writable subtrees and sensitive readable nodes.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document registers the following namespace URIs in the
<span>[<a href="#xml-registry" class="cite xref">xml-registry</a>]</span> as per <span>[<a href="#RFC3688" class="cite xref">RFC3688</a>]</span>:<a href="#section-9-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-2">
        <dt id="section-9-2.1">URI:</dt>
        <dd style="margin-left: 1.5em" id="section-9-2.2">
          <p id="section-9-2.2.1">urn:ietf:params:xml:ns:yang:ietf-tpm-remote-attestation-stream<a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-2.2.2">
            <dt id="section-9-2.2.2.1">Registrant Contact:</dt>
            <dd style="margin-left: 1.5em" id="section-9-2.2.2.2">
              <p id="section-9-2.2.2.2.1">The IESG.<a href="#section-9-2.2.2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-9-2.2.2.3">XML:</dt>
            <dd style="margin-left: 1.5em" id="section-9-2.2.2.4">
              <p id="section-9-2.2.2.4.1">N/A; the requested URI is an XML namespace.<a href="#section-9-2.2.2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-9-3">This document registers the following YANG module in the
registry <span>[<a href="#yang-parameters" class="cite xref">yang-parameters</a>]</span> as per Section 14 of <span>[<a href="#RFC6020" class="cite xref">RFC6020</a>]</span>:<a href="#section-9-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-4">
        <dt id="section-9-4.1">Name:</dt>
        <dd style="margin-left: 1.5em" id="section-9-4.2">
          <p id="section-9-4.2.1">ietf-tpm-remote-attestation-stream<a href="#section-9-4.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9-4.2.2">
            <dt id="section-9-4.2.2.1">Namespace:</dt>
            <dd style="margin-left: 1.5em" id="section-9-4.2.2.2">
              <p id="section-9-4.2.2.2.1">urn:ietf:params:xml:ns:yang:ietf-tpm-remote-attestation-stream<a href="#section-9-4.2.2.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-9-4.2.2.3">Prefix:</dt>
            <dd style="margin-left: 1.5em" id="section-9-4.2.2.4">
              <p id="section-9-4.2.2.4.1">tras<a href="#section-9-4.2.2.4.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-9-4.2.2.5">Reference:</dt>
            <dd style="margin-left: 1.5em" id="section-9-4.2.2.6">
              <p id="section-9-4.2.2.6.1">draft-ietf-rats-network-device-subscription (RFC form)<a href="#section-9-4.2.2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-rats-reference-interaction-models">[I-D.ietf-rats-reference-interaction-models]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Eckel, M.</span>, <span class="refAuthor">Pan, W.</span>, and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Reference Interaction Models for Remote Attestation Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-reference-interaction-models-15</span>, <time datetime="2025-11-05" class="refDate">5 November 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15">https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3688">[RFC3688]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"The IETF XML Registry"</span>, <span class="seriesInfo">BCP 81</span>, <span class="seriesInfo">RFC 3688</span>, <span class="seriesInfo">DOI 10.17487/RFC3688</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3688">https://www.rfc-editor.org/rfc/rfc3688</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6020">https://www.rfc-editor.org/rfc/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8639">[RFC8639]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Clemm, A.</span>, <span class="refAuthor">Gonzalez Prieto, A.</span>, <span class="refAuthor">Nilsen-Nygaard, E.</span>, and <span class="refAuthor">A. Tripathy</span>, <span class="refTitle">"Subscription to YANG Notifications"</span>, <span class="seriesInfo">RFC 8639</span>, <span class="seriesInfo">DOI 10.17487/RFC8639</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8639">https://www.rfc-editor.org/rfc/rfc8639</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9683">[RFC9683]</dt>
        <dd>
<span class="refAuthor">Fedorkow, G. C., Ed.</span>, <span class="refAuthor">Voit, E.</span>, and <span class="refAuthor">J. Fitzgerald-McKay</span>, <span class="refTitle">"Remote Integrity Verification of Network Devices Containing Trusted Platform Modules"</span>, <span class="seriesInfo">RFC 9683</span>, <span class="seriesInfo">DOI 10.17487/RFC9683</span>, <time datetime="2024-12" class="refDate">December 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9683">https://www.rfc-editor.org/rfc/rfc9683</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9684">[RFC9684]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Eckel, M.</span>, <span class="refAuthor">Bhandari, S.</span>, <span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Sulzen, B.</span>, <span class="refAuthor">Xia, L.</span>, <span class="refAuthor">Laffey, T.</span>, and <span class="refAuthor">G. C. Fedorkow</span>, <span class="refTitle">"A YANG Data Model for Challenge-Response-Based Remote Attestation (CHARRA) Procedures Using Trusted Platform Modules (TPMs)"</span>, <span class="seriesInfo">RFC 9684</span>, <span class="seriesInfo">DOI 10.17487/RFC9684</span>, <time datetime="2024-12" class="refDate">December 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9684">https://www.rfc-editor.org/rfc/rfc9684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM2.0">[TPM2.0]</dt>
      <dd>
<span class="refAuthor">TCG</span>, <span class="refTitle">"TPM 2.0 Library Specification"</span>, <span>n.d.</span>, <span>&lt;<a href="https://trustedcomputinggroup.org/resource/tpm-library-specification/">https://trustedcomputinggroup.org/resource/tpm-library-specification/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.birkholz-rats-tuda">[I-D.birkholz-rats-tuda]</dt>
        <dd>
<span class="refAuthor">Fuchs, A.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">McDonald, I.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Time-Based Uni-Directional Attestation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-birkholz-rats-tuda-07</span>, <time datetime="2022-07-10" class="refDate">10 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-birkholz-rats-tuda-07">https://datatracker.ietf.org/doc/html/draft-birkholz-rats-tuda-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KGV">[KGV]</dt>
        <dd>
<span class="refAuthor">TCG</span>, <span class="refTitle">"KGV"</span>, <time datetime="2003-10" class="refDate">October 2003</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG-NetEq-Attestation-Workflow-Outline_v1r9b_pubrev.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG-NetEq-Attestation-Workflow-Outline_v1r9b_pubrev.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7923">[RFC7923]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Clemm, A.</span>, and <span class="refAuthor">A. Gonzalez Prieto</span>, <span class="refTitle">"Requirements for Subscription to YANG Datastores"</span>, <span class="seriesInfo">RFC 7923</span>, <span class="seriesInfo">DOI 10.17487/RFC7923</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7923">https://www.rfc-editor.org/rfc/rfc7923</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8641">[RFC8641]</dt>
        <dd>
<span class="refAuthor">Clemm, A.</span> and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Subscription to YANG Notifications for Datastore Updates"</span>, <span class="seriesInfo">RFC 8641</span>, <span class="seriesInfo">DOI 10.17487/RFC8641</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8641">https://www.rfc-editor.org/rfc/rfc8641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCG-Glossary">[TCG-Glossary]</dt>
        <dd>
<span class="refAuthor">TCG</span>, <span class="refTitle">"TCG Glossary Version 1.1"</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG-Glossary-V1.1-Rev-1.0.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG-Glossary-V1.1-Rev-1.0.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="xml-registry">[xml-registry]</dt>
        <dd>
<span class="refTitle">"IETF XML Registry"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/xml-registry/xml-registry.xhtml">https://www.iana.org/assignments/xml-registry/xml-registry.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="yang-parameters">[yang-parameters]</dt>
      <dd>
<span class="refTitle">"YANG Parameters"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/yang-parameters/yang-parameters.xhtml">https://www.iana.org/assignments/yang-parameters/yang-parameters.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">Shout-out to Thomas Fossati, Zhuoyao Lin, Yogesh Despande, Jun Zhang, Thanassis Giannetsos, Michael Richardson, Ned Smith, and Chunchi (Peter) Liu for their extensive review feedback that was vital to produce this document.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@sit.fraunhofer.de" class="email">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Eric Voit</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:evoit@cisco.com" class="email">evoit@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Wei Pan</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div dir="auto" class="left"><span class="street-address">101 Software Avenue, Yuhuatai District</span></div>
<div dir="auto" class="left"><span class="locality">Nanjing, Jiangsu</span></div>
<div dir="auto" class="left"><span class="postal-code">210012</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:william.panwei@huawei.com" class="email">william.panwei@huawei.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
